## Table of Contents

      - [Directory Fuzzing](#Directory\Fuzzing)
    - [Page Fuzzing](#Page\Fuzzing)
  - [Page Fuzzing](#Page\Fuzzing)
    - [Question](#Question)

https://github.com/danielmiessler/SecLists
#ffuf #webpentesting #webfuzzing

```shell
[/htb]$ locate directory-list-2.3-small.txt
```
- Wordlist should be noted that `-ic` flag will ignore the copyright comments at the beginning of the file. Could throw off results.

`Ffuf` is pre-installed on your PwnBox instance. If you want to use it on your own machine, you can either use "`apt install ffuf -y`" or download it and use it from its [GitHub Repo](https://github.com/ffuf/ffuf.git)

```bash
[/htb]$ ffuf -h

HTTP OPTIONS:
  -H               Header `"Name: Value"`, separated by colon. Multiple -H flags are accepted.
  -X               HTTP method to use (default: GET)
  -b               Cookie data `"NAME1=VALUE1; NAME2=VALUE2"` for copy as curl functionality.
  
  -d               POST data
  
  -recursion       Scan recursively. Only FUZZ keyword is supported, and URL (-u) has to end in it. (default: false)
  
  -recursion-depth Maximum recursion depth. (default: 0)
  
  -u               Target URL
  
...SNIP...

MATCHER OPTIONS:
  -mc              Match HTTP status codes, or "all" for everything. (default: 200,204,301,302,307,401,403)
  
  -ms              Match HTTP response size
...SNIP...

FILTER OPTIONS:
  -fc              Filter HTTP status codes from response. Comma separated list of codes and ranges
  
  -fs              Filter HTTP response size. Comma separated list of sizes and ranges
...SNIP...

INPUT OPTIONS:
...SNIP...
  -w               Wordlist file path and (optional) keyword separated by colon. eg. '/path/to/wordlist:KEYWORD'

OUTPUT OPTIONS:
  -o               Write output to file
...SNIP...

EXAMPLE USAGE:
  Fuzz file paths from wordlist.txt, match all responses but filter out those with content-size 42.
  Colored, verbose output.
  
    ffuf -w wordlist.txt -u https://example.org/FUZZ -mc all -fs 42 -c -v
...SNIP...
```

- `-w`: Wordlists
- `-u`: URL

#### Directory Fuzzing
```bash
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ
```
	As we want to start fuzzign for web directroies, we can place the fuzz keyword where the directory would be within the URL. 
```bash
ffus -u <WORDLIST/PATH>:FUZZ -u http://server_IP/FUZZ
```

```shell-session
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ
```

### Page Fuzzing
	Extension fuzzing
- Common way to identify what types of webpages are being served is identifying the server type through the HTTP response headers then guessing the extension
	- Ex: `Apache`: `.php`,
	- `IIS`: `.asp or .aspx`
similar to how we fuzzed for directories place the ==FUZZ== keyword where the directory name would be. 
```shell
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/web-extensions.txt:FUZZ <SNIP>
```
Before we start fuzzing, we must specify which file that extension would be at the end of! We can always use two wordlists and have a unique keyword for each, and then do `FUZZ_1.FUZZ_2` to fuzz for both. However, there is one file we can always find in most websites, which is `index.*`, so we will use it as our file and fuzz extensions on it.

Now, we can rerun our command, carefully placing our `FUZZ` keyword where the extension would be after `index`:

```shell
gdxqpardo@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ
```
## Page Fuzzing

We will now use the same concept of keywords we've been using with `ffuf`, use `.php` as the extension, place our `FUZZ` keyword where the filename should be, and use the same wordlist we used for fuzzing directories:

```shell
gdxqpardo@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php
```

### Question
 *Try to use what you learned in this section to fuzz the '/blog' directory and find all pages. One of them should contain a flag. What is the flag?*
```bash
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://94.237.54.59:41786/blog/indexFUZZ

ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u http://94.237.54.59:41786/blog/FUZZ.php

curl -X GET -s -v \ 'http://94.237.54.59:41786/blog/home.php'
#ANSWER: HTB{bru73_f0r_c0mm0n_p455w0rd5}
```
